<script>
  import { fade } from "svelte/transition";
  import { dark } from "../stores/theme";
  import { color, next } from "../stores/color";

  let bucketFilled = true;

  function refillBucket() {
    bucketFilled = false;
    setTimeout(fillBucket, 800);
  }

  function fillBucket() {
    bucketFilled = true;
    next();
  }
</script>

<div on:click={refillBucket}>
  <svg
    class="w-auto h-10"
    width="192"
    height="110"
    viewBox="0 0 192 110"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M26.4036 22.8746L27.2636 38.2309C27.2636 43.3906 26.4036 47.1171
      24.6837 49.4103C22.9638 51.7035 19.3602 53.5872 13.8729 55.0614C19.2783
      56.4537 22.841 58.4193 24.5609 60.9582C26.3627 63.4152 27.2636 67.2645
      27.2636 72.5061L26.4036 86.8796C26.4036 90.4013 27.1817 93.145 28.7378
      95.1106C30.2939 96.9943 33.2013 98.059 37.4601 98.3047V109.607C28.6968
      109.279 22.4724 107.478 18.7869 104.202C15.1833 101.007 13.3815 95.7249
      13.3815 88.3538L14.2414 73.489C14.2414 67.1826 9.73693 62.801 0.727905
      60.344V49.9017C5.39622 48.837 8.79507 47.3218 10.9245 45.3562C13.1358
      43.3087 14.2414 40.6879 14.2414 37.4938L13.3815 21.8918C13.3815 14.1932
      15.1833 8.78778 18.7869 5.67557C22.4724 2.48146 28.7378 0.720607 37.583
      0.393005L37.7058 11.6952C33.3651 12.0228 30.3758 13.0875 28.7378
      14.8893C27.1817 16.6912 26.4036 19.3529 26.4036 22.8746Z"
      fill={$dark ? "white" : "black"}
    />
    <path
      d="M165.596 87.1253L164.736 71.769C164.736 66.6093 165.596 62.8829 167.316
      60.5897C169.036 58.2964 172.64 56.4127 178.127 54.9385C172.722 53.5462
      169.159 51.5806 167.439 49.0417C165.637 46.5847 164.736 42.7354 164.736
      37.4938L165.596 23.1203C165.596 19.5986 164.818 16.8549 163.262
      14.8893C161.706 13.0056 158.799 11.9409 154.54 11.6952L154.54
      0.392995C163.303 0.720594 169.527 2.5224 173.213 5.79841C176.817 8.99252
      178.618 14.2751 178.618 21.6461L177.758 36.511C177.758 42.8173 182.263
      47.199 191.272 49.656L191.272 60.0983C186.604 61.163 183.205 62.6781
      181.075 64.6437C178.864 66.6912 177.758 69.312 177.758 72.5061L178.618
      88.1081C178.618 95.8067 176.817 101.212 173.213 104.324C169.527 107.518
      163.262 109.279 154.417 109.607L154.294 98.3047C158.635 97.9771 161.624
      96.9124 163.262 95.1106C164.818 93.3088 165.596 90.647 165.596 87.1253Z"
      fill={$dark ? "white" : "black"}
    />
    {#if bucketFilled}
      <path
        transition:fade
        d="M123.728 58.393L95.4378 86.3147C89.9283 91.7524 80.9958 91.7524
        75.4863 86.3147L58.8601 69.9051C55.6752 66.7617 54.3314 62.4892 54.8288
        58.393H123.728Z"
        fill={$color}
        id="paintInBucket"
      />
    {/if}
    {#if bucketFilled}
      <mask id="airInBucket" fill="white" transition:fade>
        <path
          d="M92.3789 9.16808C93.4558 8.09112 95.2019 8.09113 96.2789
          9.16808L135.279 48.1682C136.356 49.2451 136.356 50.9912 135.279
          52.0682L96.2789 91.0683C89.8171 97.53 79.3406 97.53 72.8788
          91.0683L53.3788 71.5682C46.917 65.1065 46.917 54.6299 53.3788
          48.1682L92.3789 9.16808Z"
        />
      </mask>
      <path
        transition:fade
        d="M92.3789 9.16808C93.4558 8.09112 95.2019 8.09113 96.2789
        9.16808L135.279 48.1682C136.356 49.2451 136.356 50.9912 135.279
        52.0682L96.2789 91.0683C89.8171 97.53 79.3406 97.53 72.8788
        91.0683L53.3788 71.5682C46.917 65.1065 46.917 54.6299 53.3788
        48.1682L92.3789 9.16808Z"
        stroke={$dark ? "white" : "black"}
        stroke-width="22.0618"
        mask="url(#airInBucket)"
      />
      <rect
        transition:fade
        x="59.2261"
        y="7.21808"
        width="55.1545"
        height="11.0309"
        rx="5.51545"
        transform="rotate(45 59.2261 7.21808)"
        fill={$dark ? "white" : "black"}
      />
    {:else}
      <mask transition:fade id="airInBucket" fill="white">
        <path
          d="M129.923 34.3957C131.394 34.7899 132.268 36.3021 131.873
          37.7732L117.598 91.0483C117.204 92.5195 115.692 93.3925 114.221
          92.9983L60.9457 78.7233C52.1188 76.3581 46.8805 67.2852 49.2457
          58.4583L56.3832 31.8207C58.7483 22.9938 67.8213 17.7555 76.6482
          20.1207L129.923 34.3957Z"
        />
      </mask>
      <path
        transition:fade
        d="M129.923 34.3957C131.394 34.7899 132.268 36.3021 131.873
        37.7732L117.598 91.0483C117.204 92.5195 115.692 93.3925 114.221
        92.9983L60.9457 78.7233C52.1188 76.3581 46.8805 67.2852 49.2457
        58.4583L56.3832 31.8207C58.7483 22.9938 67.8213 17.7555 76.6482
        20.1207L129.923 34.3957Z"
        stroke={$dark ? "white" : "black"}
        stroke-width="22.0618"
        mask="url(#airInBucket)"
      />
      <rect
        transition:fade
        x="114.906"
        y="4.58255"
        width="55.1545"
        height="11.0309"
        rx="5.51545"
        transform="rotate(105 114.906 4.58255)"
        fill={$dark ? "white" : "black"}
      />
    {/if}

    {#if bucketFilled}
      <path
        transition:fade
        d="M145.938 85.5424C145.938 91.6346 140.999 96.5733 134.907
        96.5733C128.814 96.5733 123.876 91.6346 123.876 85.5424C123.876 77.2692
        134.907 62.1017 134.907 62.1017C134.907 62.1017 145.938 77.2692 145.938
        85.5424Z"
        fill={$color}
      />
    {/if}
  </svg>
</div>
